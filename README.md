# Сервис Воркеров для Расчета Арифметической Прогрессии

## Описание

Это сервис, который в фоновом режиме рассчитывает арифметическую прогрессию. Задачи поступают в очередь через HTTP API, обрабатываются ограниченным числом параллельных воркеров (`N`) и хранятся в памяти до истечения заданного времени жизни (`TTL`).

**Основные технологии:**
- **Go** (с использованием стандартной библиотеки: `net/http`, `sync`, `time`, `flag`)
- **Конкурентность:** Горутины и каналы для реализации пула воркеров и очереди задач.
- **Swagger (OpenAPI)** для автоматической генерации интерактивной API-документации.
- **Docker**  

---


## Сборка и запуск

### Способ 1: Запуск через Docker 


1.  **Клонируйте репозиторий:**
    ```sh
    git clone https://github.com/FrozenQxc/go-worker-service
    cd go-worker-service
    ```

2.  **Запустите сервис с помощью Docker Compose:**
    ```sh
    docker-compose up --build
    ```
    Чтобы запустить в фоновом режиме, добавьте флаг `-d`:
    ```sh
    docker-compose up --build -d
    ```

3.  Сервис будет запущен и доступен по адресу `http://localhost:8080`.


### Способ 2: Локальный запуск 

1.  Перейдите в папку проекта и установите зависимости:
    ```sh
    go mod tidy
    ```

2.  Запустите сервис, передав флаг `-N` для указания количества параллельных воркеров:
    ```sh
    go run ./cmd/main.go -N=5
    ```

3.  Сервис будет доступен по адресу `http://localhost:8080`.

---

## Конфигурация

Количество параллельных воркеров (`N`) задается при запуске сервиса.

-   При **локальном запуске** используется флаг командной строки: `-N=10`.
-   При **запуске через Docker** значение задается в файле `docker-compose.yml` в секции `command`. По умолчанию установлено `5` воркеров.

---

## API Документация

Наиболее удобный способ протестировать API — через интерактивный **Swagger UI**, который доступен после запуска сервиса по адресу:

**[http://localhost:8080/swagger/index.html](http://localhost:8080/swagger/index.html)**

### Краткое описание эндпоинтов

#### 1. Поставить задачу в очередь
-   **`POST /tasks`**
-   **Описание:** Создает новую задачу для расчета прогрессии и ставит ее в очередь.
-   **Тело запроса (JSON):**
    ```json
    {
      "n": 10,
      "d": 1.5,
      "n1": 2.0,
      "I": 2,
      "TTL": 60
    }
    ```
-   **Пример запроса с `curl`:**
    ```sh
    curl -X POST http://localhost:8080/tasks \
    -H "Content-Type: application/json" \
    -d '{"n": 10, "d": 1.5, "n1": 2.0, "I": 2, "TTL": 60}'
    ```

#### 2. Получить список задач
-   **`GET /tasks`**
-   **Описание:** Возвращает отсортированный список всех задач (в очереди, в процессе, завершенные) и их текущий статус.
-   **Пример запроса с `curl`:**
    ```sh
    curl http://localhost:8080/tasks
    ```
---

## Структура проекта

Проект имеет простую, но масштабируемую структуру, разделяющую ответственности:
-   `cmd/main.go`: Точка входа, инициализация зависимостей и запуск сервиса.
-   `internal/api/`: Слой HTTP-обработчиков (хендлеров), отвечающий за прием запросов и отправку ответов.
-   `internal/service/`: Ядро приложения, содержащее бизнес-логику:
    -   `task.go`: Определение основной сущности `Task`.
    -   `storage.go`: Потокобезопасное хранилище задач в памяти.
    -   `worker.go`: Реализация пула воркеров и фоновой обработки задач.